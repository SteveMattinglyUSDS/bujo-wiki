# 2023-06-02 Fri

## schema versioning

- should be scala, so can be used front and/or backend
- maybe like tax year it is a writable fact in the dictionary; would persist
- use 1 for first value
- on load, compare versions, with 0 as default; if mismatch:
    - for input of version n, run functions n...current, where each migrates up one version

### self-documenting schema changes?

- add properties to dictionary nodes: `sinceSchema`, `untilSchema`; defaults are 0 and infinity, respectively
- on reading old version n, find all nodes with either value > n; apply them in numeric order


dictionary:
insert: no problem
delete: no problem; fact may be persisted, but nothing would use it
modify:
  comp node "formula": no problem; will recalc
  node data type: this bit us
  enum value removed: seems problematic
  enum value added: no problem; user would need to modify data if they wanted it
  enum value changed: disallowed?
  writeable becomes derived: would need to remove it from persister?
  derived becomes writable: would have to have entry from user
  fact moves (path changes): 
    writeable: either user must re-enter, or we can convert
    derived: it will calc; old path would not be persisted